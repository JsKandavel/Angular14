{"ast":null,"code":"import { LessonsService } from \"../services/lessons.service\";\nimport { of } from 'rxjs';\nimport { SwPush } from \"@angular/service-worker\";\nimport { NewsletterService } from \"../services/newsletter.service\";\nimport { catchError } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/lessons.service\";\nimport * as i2 from \"@angular/service-worker\";\nimport * as i3 from \"../services/newsletter.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/router\";\nconst _c0 = function (a1) {\n  return [\"/lessons\", a1];\n};\nfunction LessonsComponent_tr_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\", 6)(1, \"td\", 7);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\", 8)(4, \"i\", 9);\n    i0.ɵɵtext(5, \"access_time\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"span\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const lesson_r1 = ctx.$implicit;\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(3, _c0, lesson_r1.id));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", lesson_r1.description, \" \");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(lesson_r1.duration);\n  }\n}\nexport class LessonsComponent {\n  constructor(lessonsService, swPush, newsletterService) {\n    this.lessonsService = lessonsService;\n    this.swPush = swPush;\n    this.newsletterService = newsletterService;\n    this.VAPID_PUBLIC_KEY = \"BLnVk1MBGFBW4UxL44fuoM2xxQ4o9CuxocVzKn9UVmnXZEyPCTEFjI4sALMB8qN5ee67yZ6MeQWjd5iyS8lINAg\";\n  }\n  ngOnInit() {\n    this.loadLessons();\n  }\n  loadLessons() {\n    this.lessons$ = this.lessonsService.loadAllLessons().pipe(catchError(err => of([])));\n  }\n  subscribeToNotifications() {\n    this.swPush.requestSubscription({\n      serverPublicKey: this.VAPID_PUBLIC_KEY\n    }).then(sub => {\n      this.sub = sub;\n      console.log(\"Notification Subscription: \", sub);\n      this.newsletterService.addPushSubscriber(sub).subscribe(() => console.log('Sent push subscription object to server.'), err => console.log('Could not send subscription object to server, reason: ', err));\n    }).catch(err => console.error(\"Could not subscribe to notifications\", err));\n  }\n  sendNewsletter() {\n    console.log(\"Sending Newsletter to all Subscribers ...\");\n    this.newsletterService.send().subscribe();\n  }\n}\nLessonsComponent.ɵfac = function LessonsComponent_Factory(t) {\n  return new (t || LessonsComponent)(i0.ɵɵdirectiveInject(i1.LessonsService), i0.ɵɵdirectiveInject(i2.SwPush), i0.ɵɵdirectiveInject(i3.NewsletterService));\n};\nLessonsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: LessonsComponent,\n  selectors: [[\"lessons\"]],\n  decls: 12,\n  vars: 4,\n  consts: [[1, \"lessons-list-container\", \"v-h-center-block-parent\"], [1, \"buttons\"], [1, \"button\", \"button-primary\", 3, \"disabled\", \"click\"], [1, \"button\", \"button-danger\", 3, \"click\"], [1, \"table\", \"lessons-list\", \"card\", \"card-strong\"], [3, \"routerLink\", 4, \"ngFor\", \"ngForOf\"], [3, \"routerLink\"], [1, \"lesson-title\"], [1, \"duration\"], [1, \"md-icon\", \"duration-icon\"]],\n  template: function LessonsComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"button\", 2);\n      i0.ɵɵlistener(\"click\", function LessonsComponent_Template_button_click_2_listener() {\n        return ctx.subscribeToNotifications();\n      });\n      i0.ɵɵtext(3, \"Subscribe\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"button\", 3);\n      i0.ɵɵlistener(\"click\", function LessonsComponent_Template_button_click_4_listener() {\n        return ctx.sendNewsletter();\n      });\n      i0.ɵɵtext(5, \"Send\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(6, \"h2\");\n      i0.ɵɵtext(7, \"All Lessons - V11\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(8, \"table\", 4)(9, \"tbody\");\n      i0.ɵɵtemplate(10, LessonsComponent_tr_10_Template, 8, 5, \"tr\", 5);\n      i0.ɵɵpipe(11, \"async\");\n      i0.ɵɵelementEnd()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"disabled\", ctx.sub);\n      i0.ɵɵadvance(8);\n      i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(11, 2, ctx.lessons$));\n    }\n  },\n  dependencies: [i4.NgForOf, i5.RouterLink, i4.AsyncPipe],\n  styles: [\"h2[_ngcontent-%COMP%]{text-align:center}.buttons[_ngcontent-%COMP%]{text-align:center;margin-top:20px;margin-bottom:20px}\"]\n});","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}